<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>25-2017-12-26-练习-脚本进阶3</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>25-2017-12-26-练习-脚本进阶3</h1>
<div class="section" id="id2">
<h2>练习1</h2>
<p>1、利用expect 实现FTP自动上传文件</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#================================================</span>
<span class="c1">#FileName   :test_expect_46_zhaojiedi.sh</span>
<span class="c1">#Author     :zhaojiedi</span>
<span class="c1">#Description:</span>
<span class="c1">#DateTime   :2017-12-26 14:47:37</span>
<span class="c1">#Version    :V1.0</span>
<span class="c1">#Other      :</span>
<span class="c1">#================================================</span>

<span class="c1"># usage ./test_expect_46_zhaojiedi.sh 172.18.101.69 test test /etc/issue /ftp/issue</span>
<span class="nv">host</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">username</span><span class="o">=</span><span class="nv">$2</span>
<span class="nv">password</span><span class="o">=</span><span class="nv">$3</span>
<span class="nv">file</span><span class="o">=</span><span class="nv">$4</span>
<span class="nv">upload_dir</span><span class="o">=</span><span class="nv">$5</span>

expect <span class="s">&lt;&lt;EOF</span>
<span class="s">set timeout 10</span>
<span class="s">spawn ftp $host</span>
<span class="s">expect {</span>
<span class="s">        &quot;Name&quot; { send &quot;$username\n&quot;; exp_continue }</span>
<span class="s">        &quot;Password:&quot; { send &quot;$password\n&quot;;exp_continue }</span>
<span class="s">        &quot;ftp&gt;&quot; { send &quot;put $file $upload_dir\n&quot;; }</span>
<span class="s">}</span>
<span class="s">expect &quot;ftp&gt;&quot; { send &quot;bye\n&quot; }</span>
<span class="s">EOF</span>
</pre></div>
</div>
<p>2、数组：实现杨辉三角（选做）</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#================================================</span>
<span class="c1">#FileName   :test_yanghuisanjiao_46_zhaojiedi.sh</span>
<span class="c1">#Author     :zhaojiedi</span>
<span class="c1">#Description:</span>
<span class="c1">#DateTime   :2017-12-26 18:03:09</span>
<span class="c1">#Version    :V1.0</span>
<span class="c1">#Other      :</span>
<span class="c1">#================================================</span>
<span class="nv">line</span><span class="o">=</span><span class="m">7</span>
<span class="nv">count</span><span class="o">=</span>$<span class="o">[</span>line**2-1<span class="o">]</span>
<span class="nb">declare</span> -a arr
<span class="nb">declare</span> -a arr_last

print_arr_last<span class="o">(){</span>
        <span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> $<span class="o">[</span>line-1<span class="o">]</span> <span class="sb">`</span> <span class="p">;</span> <span class="k">do</span>
                <span class="nb">echo</span> <span class="si">${</span><span class="nv">arr_last</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span>
        <span class="k">done</span>
<span class="o">}</span>

<span class="c1"># init arr_last</span>
<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> $<span class="o">[</span>line-1<span class="o">]</span><span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
        <span class="nv">ii</span><span class="o">=</span>$<span class="o">[</span>i+1<span class="o">]</span>
        arr_last<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span>$<span class="o">[</span><span class="nv">$ii</span> ** <span class="m">2</span> -1 <span class="o">]</span>
<span class="k">done</span>

print_arr_last

get_location_1<span class="o">(){</span>
        <span class="nb">local</span> <span class="nv">loc</span><span class="o">=</span><span class="nv">$1</span>
        <span class="nb">local</span> <span class="nv">row</span><span class="o">=</span><span class="m">0</span>
        <span class="nb">local</span> <span class="nv">col</span><span class="o">=</span><span class="m">0</span>
        <span class="k">for</span> i in <span class="sb">`</span>seq  $<span class="o">[</span>line-1<span class="o">]</span> -1 <span class="m">0</span><span class="sb">`</span> <span class="p">;</span> <span class="k">do</span>
                <span class="c1">#echo &quot;${i}==&gt;${arr_last[$i]}==&gt;&quot;</span>
                <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$loc</span><span class="s2">&quot;</span> -gt  <span class="si">${</span><span class="nv">arr_last</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
                        <span class="nv">row</span><span class="o">=</span>$<span class="o">[</span>i+1<span class="o">]</span>
                        <span class="nv">col</span><span class="o">=</span>$<span class="o">[</span> loc-row**2<span class="o">]</span>
                        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$row</span><span class="s2">,</span><span class="nv">$col</span><span class="s2">&quot;</span>
                        <span class="k">return</span> <span class="m">0</span>
                <span class="k">fi</span>
        <span class="k">done</span>
        <span class="nb">echo</span>  <span class="s2">&quot;0,0&quot;</span>
<span class="o">}</span>
<span class="c1"># get_location_1 8</span>
get_location_2<span class="o">(){</span>
        <span class="nb">local</span> <span class="nv">row</span><span class="o">=</span><span class="nv">$1</span>
        <span class="nb">local</span> <span class="nv">col</span><span class="o">=</span><span class="nv">$2</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span>$<span class="s2">[row ** 2 + col]&quot;</span>
<span class="o">}</span>
<span class="c1">#get_location_2 2 3</span>
is_last_col<span class="o">(){</span>
        <span class="nb">local</span> <span class="nv">row</span><span class="o">=</span><span class="nv">$1</span>
        <span class="nb">local</span> <span class="nv">col</span><span class="o">=</span><span class="nv">$2</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$col</span><span class="s2">&quot;</span> -eq <span class="s2">&quot;</span>$<span class="s2">[row * 2]&quot;</span> <span class="o">]</span> <span class="p">;</span><span class="k">then</span>
                <span class="k">return</span> <span class="m">0</span>
        <span class="k">fi</span>
        <span class="k">return</span> <span class="m">1</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&quot;count=</span><span class="nv">$count</span><span class="s2">&quot;</span>


<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="nv">$count</span><span class="sb">`</span> <span class="p">;</span> <span class="k">do</span>
        <span class="nv">info</span><span class="o">=</span><span class="sb">`</span>get_location_1 <span class="nv">$i</span><span class="sb">`</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$info</span><span class="s2"> ......&quot;</span>
        <span class="nv">row</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$info</span> <span class="p">|</span>cut -d <span class="s2">&quot;,&quot;</span> -f1<span class="sb">`</span>
        <span class="nv">col</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$info</span> <span class="p">|</span>cut -d <span class="s2">&quot;,&quot;</span> -f2<span class="sb">`</span>
        <span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$row</span><span class="s2"> ... </span><span class="nv">$col</span><span class="s2"> &quot;</span>

        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$col</span><span class="s2">&quot;</span> -eq <span class="m">0</span> <span class="o">]</span> <span class="p">;</span><span class="k">then</span>
                arr<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span><span class="m">1</span>
                <span class="nb">echo</span> <span class="s2">&quot;set </span><span class="nv">$i</span><span class="s2"> 1&quot;</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$col</span><span class="s2">&quot;</span> -eq <span class="s2">&quot;</span>$<span class="s2">[row *2]&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>

                arr<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span><span class="m">1</span>
                <span class="nb">echo</span> <span class="s2">&quot;set </span><span class="nv">$i</span><span class="s2"> 1&quot;</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span>$<span class="s2">[col%2]&quot;</span> -eq <span class="m">1</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
                <span class="k">continue</span>
        <span class="k">fi</span>
        <span class="nv">loc_left</span><span class="o">=</span><span class="sb">`</span>get_location_2 $<span class="o">[</span>row-1<span class="o">]</span> $<span class="o">[</span>col-2<span class="o">]</span><span class="sb">`</span>
        <span class="nv">loc_right</span><span class="o">=</span><span class="sb">`</span>get_location_2 $<span class="o">[</span>row-1<span class="o">]</span> <span class="nv">$col</span><span class="sb">`</span>
        <span class="nb">echo</span> <span class="s2">&quot;i,left,right==&gt;</span><span class="nv">$i</span><span class="s2"> ,</span><span class="nv">$loc_left</span><span class="s2">,</span><span class="nv">$loc_right</span><span class="s2">&quot;</span>
        <span class="nv">v1</span><span class="o">=</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$loc_left</span><span class="p">]</span><span class="si">}</span>
        <span class="nv">v2</span><span class="o">=</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$loc_right</span><span class="p">]</span><span class="si">}</span>
        <span class="nb">echo</span> <span class="s2">&quot;v1,v2=&gt;</span><span class="nv">$v1</span><span class="s2">,</span><span class="nv">$v2</span><span class="s2">&quot;</span>
        arr<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span>$<span class="o">[</span> v1 + v2 <span class="o">]</span>
<span class="k">done</span>
print_space<span class="o">(){</span>
        <span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">1</span> <span class="nv">$1</span><span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
                <span class="nb">echo</span> -n <span class="s2">&quot; &quot;</span>
        <span class="k">done</span>
<span class="o">}</span>

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> <span class="nv">$count</span><span class="sb">`</span> <span class="p">;</span> <span class="k">do</span>
        <span class="nv">info</span><span class="o">=</span><span class="sb">`</span>get_location_1 <span class="nv">$i</span><span class="sb">`</span>
        <span class="c1">#echo &quot;$info ......&quot;</span>
        <span class="nv">row</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$info</span> <span class="p">|</span>cut -d <span class="s2">&quot;,&quot;</span> -f1<span class="sb">`</span>
        <span class="nv">col</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$info</span> <span class="p">|</span>cut -d <span class="s2">&quot;,&quot;</span> -f2<span class="sb">`</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$col</span><span class="s2">&quot;</span> -eq <span class="m">0</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
                <span class="k">for</span> j in <span class="sb">`</span>seq <span class="m">1</span> $<span class="o">[</span><span class="m">2</span>*line-2*row-2<span class="o">]</span><span class="sb">`</span> <span class="p">;</span> <span class="k">do</span>
                        <span class="nb">echo</span> -n <span class="s2">&quot; &quot;</span>
                <span class="k">done</span>
        <span class="k">fi</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$col</span><span class="s2">&quot;</span> -ne  <span class="s2">&quot;</span>$<span class="s2">[row *2]&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
                <span class="nb">echo</span> -ne <span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">  &quot;</span>
        <span class="k">else</span>
                <span class="nb">echo</span> -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">  &quot;</span>
        <span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>3、输入若干个数值存入数组中，采用冒泡算法进行升序或降序排序</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#================================================</span>
<span class="c1">#FileName   :test_bubble_sort_46_zhaojiedi.sh</span>
<span class="c1">#Author     :zhaojiedi</span>
<span class="c1">#Description:</span>
<span class="c1">#DateTime   :2017-12-26 17:49:51</span>
<span class="c1">#Version    :V1.0</span>
<span class="c1">#Other      :</span>
<span class="c1">#================================================</span>

<span class="nb">read</span>  -p <span class="s2">&quot;enter some value &quot;</span>  -a arr

<span class="nv">cnt</span><span class="o">=</span><span class="si">${#</span><span class="nv">arr</span><span class="p">[*]</span><span class="si">}</span>
<span class="nb">echo</span> <span class="s2">&quot;count=&quot;</span><span class="nv">$cnt</span>
my_print <span class="o">(){</span>
        <span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> $<span class="o">[</span>cnt-1<span class="o">]</span><span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
                <span class="nb">echo</span> -ne <span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">\t&quot;</span>
        <span class="k">done</span>
        <span class="nb">echo</span>
<span class="o">}</span>
<span class="nb">echo</span> <span class="s2">&quot;befor bubble sort&quot;</span>
my_print

<span class="k">for</span> i in <span class="sb">`</span>seq <span class="m">0</span> $<span class="o">[</span>cnt-1<span class="o">]</span><span class="sb">`</span><span class="p">;</span> <span class="k">do</span>
        <span class="k">for</span> j in <span class="sb">`</span>seq <span class="m">0</span> $<span class="o">[</span>i-1<span class="o">]</span><span class="sb">`</span><span class="p">;</span><span class="k">do</span>
                <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> -lt <span class="s2">&quot;</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then</span>
                        <span class="nv">tmp</span><span class="o">=</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$i</span><span class="p">]</span><span class="si">}</span>
                        arr<span class="o">[</span><span class="nv">$i</span><span class="o">]=</span><span class="si">${</span><span class="nv">arr</span><span class="p">[</span><span class="nv">$j</span><span class="p">]</span><span class="si">}</span>
                        arr<span class="o">[</span><span class="nv">$j</span><span class="o">]=</span><span class="nv">$tmp</span>
                <span class="k">fi</span>
        <span class="k">done</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&quot;after bubble sort&quot;</span>
my_print
</pre></div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>