<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title>14-2017-11-28-练习-sed</title>
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="sed">
<h1>14-2017-11-28-练习-sed</h1>
<div class="section" id="id1">
<h2>练习1</h2>
<p>1、删除centos7系统/etc/grub2.cfg文件中所有以空白开头的行行首的空白字符</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ sed -nr <span class="s1">&#39;s@^([[:space:]]+)(.*)@\2@p&#39;</span> /etc/grub2.cfg
</pre></div>
</div>
<p>2、删除/etc/fstab文件中所有以#开头，后面至少跟一个空白字符的行的行首的#和空白字符</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ sed -nr <span class="s1">&#39;s@(^#[[:space:]])(.*)@\2@p&#39;</span> /etc/fstab
</pre></div>
</div>
<p>3、在centos6系统/root/install.log每一行行首增加#号</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos6 ~<span class="o">]</span><span class="c1"># sed -nr &#39;s@.*@#\0@p&#39; /root/install.log</span>
</pre></div>
</div>
<p>4、在/etc/fstab文件中不以#开头的行的行首增加#号</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos6 ~<span class="o">]</span><span class="c1"># sed -nr &#39;s@^[^#].*@#\0@p&#39; /etc/fstab</span>
</pre></div>
</div>
<p>5、处理/etc/fstab路径,使用sed命令取出其目录名和基名</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos6 ~<span class="o">]</span><span class="c1"># echo &quot;/etc/fstab&quot;   |sed -nr &#39;s@(.*/)([^/]+)/?@\2@p&#39;</span>
fstab
<span class="o">[</span>root@centos6 ~<span class="o">]</span><span class="c1"># echo &quot;/etc/fstab/&quot;   |sed -nr &#39;s@(.*/)([^/]+)/?@\2@p&#39;</span>
fstab
<span class="o">[</span>root@centos6 ~<span class="o">]</span><span class="c1"># echo &quot;/etc/&quot;   |sed -nr &#39;s@(.*/)([^/]+)/?@\1@p&#39;</span>
/
</pre></div>
</div>
<p>6、利用sed 取出ifconfig命令中本机的IPv4地址</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ ifconfig ens33 <span class="p">|</span>sed -nr <span class="s1">&#39;2s@.*inet (.*) netmask.*@\1@p&#39;</span>
</pre></div>
</div>
<p>7、统计centos安装光盘中Package目录下的所有rpm文件的以.分隔倒数第二个字段的重复次数</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>root@centos7 ~<span class="o">]</span>$ ls /misc/cd/Packages/ <span class="p">|</span>sed -nr <span class="s1">&#39;s@.*\.([^.]*)\.rpm@\1@p&#39;</span> <span class="p">|</span>sort  <span class="p">|</span>uniq -c
<span class="m">2141</span> i686
<span class="m">3076</span> noarch
<span class="m">4374</span> x86_64
</pre></div>
</div>
<p>8、统计/etc/init.d/functions文件中每个单词的出现次数，并排序（用grep和sed两种方法分别实现）</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cat  /etc/init.d/functions  <span class="p">|</span> egrep -o <span class="s2">&quot;([[:alpha:]]+)&quot;</span>  <span class="p">|</span>sort <span class="p">|</span>uniq -c  &gt; /root/grep.txt
cat /etc/init.d/functions <span class="p">|</span> sed -r <span class="s1">&#39;s@[^[:alpha:]]@\n@g&#39;</span> <span class="p">|</span>sed <span class="s1">&#39;/^$/d&#39;</span> <span class="p">|</span>sort <span class="p">|</span>uniq -c  &gt;/root/sed.txt
diff /root/sed.txt /root/grep.txt
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">警告</p>
<p>这个题，2种结果必须是一致的， 如果第二种方式没有sed -nr 's&#64;.*&#64;#0&#64;p' 就会少统计行单独为fi的行。</p>
</div>
<p>9、将文本文件的n和n+1行合并为一行，n为奇数行</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="o">[</span>root@centos7 ~<span class="o">]</span>$ sed <span class="s1">&#39;N;s@\n@@&#39;</span> /etc/fstab
</pre></div>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>